<div id="loading-overlay" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999;">
    <div class="loading-spinner" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
        <div class="spinner"></div>
        <p style="color: white; text-align: center; margin-top: 10px;">Yükleniyor...</p>
    </div>
</div>

<script>
    // Loading animasyonunu gösterme
    function showLoadingAnimation() {
        document.getElementById('loading-overlay').style.display = 'block';
        disableUserInteraction();
        setupBeforeUnloadWarning();
    }

    // Loading animasyonunu gizleme
    function hideLoadingAnimation() {
        document.getElementById('loading-overlay').style.display = 'none';
        enableUserInteraction();
        removeBeforeUnloadWarning();
    }

    // Kullanıcı etkileşimini devre dışı bırakma
    function disableUserInteraction() {
        document.body.style.pointerEvents = 'none';
        document.getElementById('loading-overlay').style.pointerEvents = 'auto';
    }

    // Kullanıcı etkileşimini tekrar aktif etme
    function enableUserInteraction() {
        document.body.style.pointerEvents = 'auto';
    }

    // Sayfa yenileme/kapatma uyarısını ayarlama
    function setupBeforeUnloadWarning() {
        window.onbeforeunload = function() {
            return "İşlem devam ediyor. Sayfadan ayrılmak istediğinize emin misiniz?";
        };
    }

    // Sayfa yenileme/kapatma uyarısını kaldırma
    function removeBeforeUnloadWarning() {
        window.onbeforeunload = null;
    }

    // Generic AJAX çağrısı yapan fonksiyon
    function makeAjaxCall(options) {
        showLoadingAnimation();

        // Varsayılan ayarlar
        const defaultSettings = {
            method: 'GET',
            url: '',
            data: null,
            contentType: 'application/json',
            beforeSend: function() {},
            success: function(response) {
                console.log('İşlem başarılı:', response);
            },
            error: function(xhr, status, error) {
                console.error('Hata oluştu:', error);
            },
            complete: function() {
                hideLoadingAnimation();
            }
        };

        // Kullanıcının ayarları ile varsayılan ayarları birleştir
        const settings = { ...defaultSettings, ...options };

        // AJAX isteği
        return $.ajax({
            url: settings.url,
            method: settings.method,
            data: settings.data,
            contentType: settings.contentType,
            beforeSend: function() {
                settings.beforeSend();
            },
            success: function(response) {
                settings.success(response);
            },
            error: function(xhr, status, error) {
                settings.error(xhr, status, error);
            },
            complete: function() {
                settings.complete();
            }
        });
    }

    // Kullanıcı işlemi iptal etmek isterse
    function checkIfUserWantsToCancel() {
        if (confirm("İşlemi iptal etmek istediğinize emin misiniz?")) {
            hideLoadingAnimation();
            return true;
        }
        return false;
    }
</script>

<style>
    .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid #f3f3f3;
        border-radius: 50%;
        border-top: 5px solid #3498db;
        animation: spin 1s linear infinite;
        margin: 0 auto;
    }

    @@keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>

