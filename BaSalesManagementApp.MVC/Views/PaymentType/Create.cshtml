@using Microsoft.Extensions.Localization
@inject IStringLocalizer<Resource> localizer
@model BaSalesManagementApp.MVC.Models.PaymentTypeVMs.PaymentTypeCreateVM

@{
    ViewData["Title"] = localizer["Create"];
}
@* ONR 16042025 00:51*@

<div class="w-100 flex-grow-1 p-4" style="background-color: #f5f5f5;">
    <h4 class="py-3 mb-4">
        <span class="text-muted fw-light">@localizer["PaymentType"] /</span>
        @localizer["Create"]
    </h4>
@*        <div class="row">
            <div class="content-wrapper">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-body"> *@
                            <form asp-action="Create" onsubmit="return validateForm()">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>

        <div class="mb-3">
            <input asp-for="CompanyId" type="hidden" />
        </div>

        <div class="mb-3">
            <label asp-for="Name" class="form-label">@localizer["PaymentTypeName"].ToString().ToUpper(new System.Globalization.CultureInfo("tr-TR"))</label>
            <input asp-for="Name" id="PaymentTypeName" class="form-control"
                   data-val="true"
                   data-val-required="@localizer["PaymentType name is required."]"
                   data-val-minlength="@localizer["PaymentType name must be at least 2 characters."]"
                   data-val-maxlength="@localizer["PaymentType name cannot exceed 128 characters."]" />
            <span asp-validation-for="Name" id="paymentTypeNameError" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Rate" class="form-label">@localizer["Rate"].ToString().ToUpper(new System.Globalization.CultureInfo("tr-TR"))</label>
            <input asp-for="Rate" id="PaymentTypeRate" type="number" step="0.01" class="form-control"
                   data-val="true"
                   data-val-required="@localizer["RateIsRequired"]"
                   data-val-range="@localizer["Rate must be between 0 and 100."]"
                   min="0.00" max="100" />
            <span asp-validation-for="Rate" id="paymentTypeRateError" class="text-danger"></span>
        </div>

                                <div class="mb-3">
                                    <input type="submit" value="@localizer["Save"]" class="btn btn-primary" />
                                    <a asp-action="Index" class="btn btn-secondary">
                                        @localizer["BackToList"]
                                    </a>
                                </div>
                            </form>
                        </div>
@*                     </div>
                </div>
            </div>
        </div>
    </div>
</div> *@

@section Scripts {
    <script>
        function validateForm() {
            var nameError = $('#paymentTypeNameError').text();
            var rateError = $('#paymentTypeRateError').text();

            if (nameError || rateError) {
                return false;  // Form gönderimini engelle
            }
            return true;  // Formu gönder
        }

        $(document).ready(function () {
            // Name Validation
            $('#PaymentTypeName').on('input', function () {
                var nameValue = $(this).val();
                var errorMessage = $('#paymentTypeNameError');

                var requiredMessage = $(this).data('val-required');
                var minLengthMessage = $(this).data('val-minlength');
                var maxLengthMessage = $(this).data('val-maxlength');

                if (nameValue.length === 0) {
                    errorMessage.text(requiredMessage).show();
                } else if (nameValue.length < 2) {
                    errorMessage.text(minLengthMessage).show();
                } else if (nameValue.length > 128) {
                    errorMessage.text(maxLengthMessage).show();
                } else {
                    errorMessage.text('').hide();
                }
            });

            // Rate Validation
            $('#PaymentTypeRate').on('input', function () {
                var rateValue = parseFloat($(this).val());
                var errorMessage = $('#paymentTypeRateError');

                var requiredMessage = $(this).data('val-required');
                var rangeMessage = $(this).data('val-range');
                var minValue = parseFloat($(this).attr('min'));
                var maxValue = parseFloat($(this).attr('max'));

                if (isNaN(rateValue) || rateValue < minValue || rateValue > maxValue) {
                    errorMessage.text(rangeMessage).show();
                } else {
                    errorMessage.text('').hide();
                }
            });
        });
    </script>
}
